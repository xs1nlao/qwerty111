AI-помощник для проверки лечения онкопациентов
QWERTY123 — это интеллектуальная система, разработанная для автоматической проверки соответствия планов лечения онкологических пациентов актуальным клиническим рекомендациям (Минздрав РФ, NCCN, ESMO). Проект создан в рамках кейс-чемпионата и призван помочь врачам и пациентам убедиться в правильности назначенной терапии, снизить риск ошибок и повысить информированность

Система предоставляет два интерфейса:
*   Для врача: Детальный анализ с указанием источников, расчетом compliance_score (процента соответствия стандартам) и разбором каждой линии терапии.
*   Для пациента: Понятное объяснение на простом языке, ключевые выводы и список вопросов для лечащего врача.

Ключевые возможности

*   Анализ истории болезни: Принимает на вход текст или файлы (.txt, .pdf, .docx).
*   Интеграция с AI (DeepSeek): Используется для определения типа рака, извлечения линий терапии и оценки назначений при отсутствии данных в локальной базе.
*   База знаний Минздрава РФ: Загружает и использует официальные клинические рекомендации для точного расчета соответствия лечению.
*   Международные гайдлайны: Предоставляет ссылки на актуальные рекомендации NCCN и ESMO.
*   Интерактивный сбор информации: Если данных недостаточно, система задает уточняющие вопросы, влияющие на итоговую оценку.
*   Управление пациентами: Врач может создавать карточки пациентов и просматривать историю их проверок.
*   Анализ маммограмм: Отдельный модуль для первичного AI-анализа изображений маммограмм (демо-режим).
*   Сбор метрик: Система автоматически собирает статистику использования, времени ответа и распределения правильности подсчета.



Архитектура решения

1.  Фронтенд (Frontend): React (TypeScript) приложение. Отвечает за пользовательский интерфейс, маршрутизацию, отправку запросов на бэкенд и отображение результатов.
2.  Бэкенд (Backend): Flask (Python) сервер. Обрабатывает все запросы от фронтенда, управляет бизнес-логикой.
3.  AI Сервис (`ai_service.py`): Центральный модуль для взаимодействия с DeepSeek API. Отвечает за:
    *   Определение типа рака.
    *   Извлечение линий терапии.
    *   Интеллектуальный анализ недостающей информации.
4.  Модуль скоринга (`scoring.py`): Вычисляет compliance_score. Сначала пытается найти назначенные препараты в локальной базе протоколов (protocols_db), загруженной из JSON-файлов Минздрава. В случае неудачи делегирует оценку AI-сервису.
5.  Загрузчик базы знаний (`knowledge_base_loader.py`): Парсит и индексирует все JSON-файлы с клиническими рекомендациями из папки data/, создавая удобный кэш для быстрого доступа.
6.  Менеджер пациентов (`patient_manager.py`): Отвечает за CRUD-операции с данными пациентов и историей их проверок, сохраняя все в patients_db.json.
7.  Модуль маммограмм (`mammogram_model.py`): Инкапсулирует логику AI-модели для анализа изображений. В текущей версии работает в демо-режиме, но архитектура позволяет легко подключить реальную модель.
8.  Сборщик метрик (`metrics_collector.py`): Собирает статистику работы системы для последующего анализа.


Поток данных

1.  Ввод: Пользователь (врач или пациент) вводит историю болезни в текстовое поле или загружает файлы.
2.  Запрос: Фронтенд отправляет POST-запрос на /api/check-treatment (или /api/check-treatment-with-files) с данными.
3.  Анализ AI:
    Бэкенд вызывает ai_service.detect_cancer_type() для определения типа рака.
    Вызывает ai_service.extract_treatment_lines() для структурирования истории в линии терапии.
    Параллельно извлекает биомаркеры с помощью ai_service.extract_biomarkers().
4.  Скоринг: Данные передаются в scorer.calculate_score_from_protocols(). Модуль ищет подходящие протоколы в базе Минздрава. Если протокол найден, оценка выставляется на его основе. Если нет — запрашивается оценка у AI.
5.  Обогащение: Результаты AI и скоринга объединяются в модуле ai_service.enhance_response_with_guidelines(). Сюда добавляются ссылки на гайдлайны, версия для пациента и т.д.
6.  Ответ: Богатый JSON-объект с результатами отправляется обратно на фронтенд.
7.  Отображение: Фронтенд рендерит результаты в зависимости от роли пользователя (врач/пациент).



Установка и запуск

Предварительные требования
Python 3.9+
Node.js 18+ и npm
Git
API ключ DeepSeek (https://platform.deepseek.com/api_keys)

Инструкция по установке

1.  Клонируйте репозиторий:
git clone https://github.com/xs1nlao/qwerty111.git

2.  Настройка бэкенда:
   Перейдите в папку с бэкендом.
   Создайте виртуальное окружение и активируйте его:
python -m venv venv
.\venv\Scripts\activate
        
   Установите зависимости (cd backend):
pip install -r requirements.txt
        
    Создайте файл .env в корне бэкенда и добавьте ваш API-ключ:
DEEPSEEK_API_KEY="ваш_ключ_сюда"
        


Настройка фронтенда:
Установите зависимости (cd qwerty111):
npm install
        

### Запуск приложения

1.  Запустите бэкенд-сервер:
   Из папки с бэкендом (например, backend/) выполните:       
python app.py
   Сервер будет запущен на http://localhost:5000.

2.  Запустите фронтенд-сервер разработки:
    Из папки frontend/ выполните:
npm run dev
        
    Приложение будет доступно по адресу, указанному в терминале (обычно http://localhost:5173).

3.  Откройте приложение: Перейдите по адресу фронтенда в браузере.












